<!DOCTYPE html>
<html>
<head>
	<title>Google Sheets API Example</title>
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
	<h1>Google Sheets API Example</h1>
<div data-sheetdb-url="https://sheetdb.io/api/v1/rv9nb09ri8tf7">
    <p>{{Anufied:)}}</p>
</div>
	<p>Enter a value in the Google Sheet:</p>
	<input type="text" id="inputValue">
	<button onclick="addValue()">Add Value</button>

	<p>Ask the webpage a response:</p>
	<button onclick="getResponse()">Get Response</button>
	<p id="response"></p>

	<script>
		// Client ID and API key from the Developer Console
		var CLIENT_ID = '1098116393162-eam41reumjkej3bs2077vl8v7n3jbkh0.apps.googleusercontent.com';
        var API_KEY = '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';

		// Array of API discovery doc URLs for APIs used by the quickstart
		var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

		// Authorization scopes required by the API; multiple scopes can be
		// included, separated by spaces.
		var SCOPES = "https://www.googleapis.com/auth/spreadsheets.edit https://www.googleapis.com/auth/spreadsheets";

		var sheetId = "1a8zw7vROK6XK4SUYpRjEkj53_9ySrZWCHaGrqrHs5uM";
		var range = "A2:B";

		// Load the API client and sign-in
		function handleClientLoad() {
			gapi.load('client:auth2', initClient);
		}

		function initClient() {
			gapi.client.init({
				apiKey: API_KEY,
				clientId: CLIENT_ID,
				discoveryDocs: DISCOVERY_DOCS,
				scope: SCOPES
			}).then(function () {
				// Listen for sign-in state changes.
				gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

				// Handle the initial sign-in state.
				updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
			}, function (error) {
				console.log(JSON.stringify(error, null, 2));
			});
		}

		function updateSigninStatus(isSignedIn) {
			if (isSignedIn) {
				console.log("User is signed in.");
			} else {
				console.log("User is not signed in.");
			}
		}

		// Add a value to the Google Sheet
		function addValue() {
			var value = $("#inputValue").val();
			gapi.client.sheets.spreadsheets.values.append({
				spreadsheetId: sheetId,
				range: range,
				valueInputOption: "RAW",
				insertDataOption: "INSERT_ROWS",
				resource: {
					values: [[new Date(), value]]
				}
			}).then(function (response) {
				console.log(JSON.stringify(response, null, 2));
				alert("Value added to Google Sheet!");
			}, function (error) {
				console.log(JSON.stringify(error, null, 2));
			});
		}

		// Get the last value from the Google Sheet and respond with it
		function getResponse() {
			gapi.client.sheets.spreadsheets.values.get({
				spreadsheetId: sheetId,
				range: range
			}).then(function (response) {
				console.log(JSON.stringify(response, null, 2));
				var values = response.result.values;
				var lastValue = values[values.length - 1][1];
				if (lastValue === "1") {
					$("#response").html("1");
				} else if (lastValue === "0") {
					$("#response").html("0");
				} else {
					$("#response").html("No value found.");
				}
			}, function (error) {
				console.log(JSON.stringify(error, null, 2));
			});
		}


	</script>

	<!-- Load the API client and sign-in -->
	<script async defer src="https://apis.google.com/js/api.js"
		onload="handleClientLoad()"></script>
</body>
</html>